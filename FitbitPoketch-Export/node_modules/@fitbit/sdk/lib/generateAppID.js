"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const os_1 = tslib_1.__importDefault(require("os"));
const fs_extra_1 = tslib_1.__importDefault(require("fs-extra"));
const lodash_1 = tslib_1.__importDefault(require("lodash"));
const uuid = tslib_1.__importStar(require("uuid"));
function generateAppID() {
    const configPath = 'package.json';
    const config = fs_extra_1.default.readJSONSync(configPath);
    if (!lodash_1.default.isPlainObject(config)) {
        throw new TypeError('Project configuration root must be an object');
    }
    if (config.fitbit === undefined)
        config.fitbit = {};
    if (!lodash_1.default.isPlainObject(config.fitbit)) {
        throw new TypeError("Project configuration 'fitbit' property must be an object");
    }
    config.fitbit.appUUID = uuid.v4();
    fs_extra_1.default.writeJSONSync(configPath, config, { spaces: 2, EOL: os_1.default.EOL });
    console.log(`Wrote new app ID: ${config.fitbit.appUUID}`);
}
exports.default = generateAppID;
